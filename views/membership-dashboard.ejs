<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= groupName %> - Membership Dashboard</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <h1><%= groupName %><br>Membership Dashboard</h1>
    <p>Members Updated: <%= membersUpdated %><br>Waiting List Updated: <%= waitingUpdated %></p>

    <table>
      <thead>
        <tr>
          <th>Section Type</th>
          <th>Section Name</th>
          <th>Members</th>
          <th>Capacity</th>
          <th>Spaces</th>
          <th>Leaders</th>
          <th>Young Leaders</th>
        </tr>
      </thead>
      <tbody>
        <% for (const [type, data] of Object.entries(grouped)) { %>
          <% data.sections.forEach(sec => { %>
            <tr>
              <td><%= type %></td>
              <td><%= sec.name %></td>
              <td><%= sec.members %></td>
              <td><%= sec.capacity %></td>
              <td><%= sec.spaces %></td>
              <td><%= sec.leaders %> (<%= sec.leaderInitials %>)</td>
              <td><%= sec.youngLeaders %> (<%= sec.youngLeaderInitials %>)</td>
            </tr>
          <% }); %>
          <tr class="subtotal">
            <td><%= type %> Subtotal</td>
            <td></td>
            <td><%= data.subtotalMembers %></td>
            <td></td>
            <td></td>
            <td><%= data.subtotalLeaders %></td>
            <td><%= data.subtotalYLs %></td>
          </tr>
        <% } %>

        <tr class="grand-total">
          <td><strong>GRAND TOTAL</strong></td>
          <td></td>
          <td><strong><%= totalMembers %></strong></td>
          <td></td>
          <td></td>
          <td><strong><%= totalLeaders %></strong></td>
          <td><strong><%= totalYLs %></strong></td>
        </tr>
      </tbody>
    </table>

    <div class="projected">
      <h2>Waiting List Age Projections</h2>
      <table>
        <thead>
          <tr>
            <th>Category</th>
            <th>Projected</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Too Young</td><td><%= projected.tooYoung %></td></tr>
          <tr><td>Squirrels</td><td><%= projected.squirrels %></td></tr>
          <tr><td>Beavers</td><td><%= projected.beavers %></td></tr>
          <tr><td>Cubs</td><td><%= projected.cubs %></td></tr>
          <tr><td>Scouts</td><td><%= projected.scouts %></td></tr>
          <tr><td>Explorers</td><td><%= projected.explorers %></td></tr>
          <tr class="grand-total">
            <td>Grand Total</td>
            <td><%= totalProjected %></td>
          </tr>
        </tbody>
      </table>
    </div>

<h2>Adjust Age Cut-offs (for projections)</h2>
<form action="/update-cutoffs" method="post">
  <table style="width:auto; margin:20px 0;">
    <thead>
      <tr>
        <th>Category</th>
        <th>Years</th>
        <th>Months</th>
      </tr>
    </thead>
    <tbody>
      <% ['Squirrels', 'Beavers', 'Cubs', 'Scouts', 'Explorers'].forEach((cat, i) => { 
        const key = ['squirrels','beavers','cubs','scouts','explorers'][i];
        const { years, months } = displayCutoffs[key] || { years: 0, months: 0 };
      %>
        <tr>
          <td><%= cat %></td>
          <td><input type="number" name="<%= key %>_years" value="<%= years %>" min="0" style="width:60px;"></td>
          <td><input type="number" name="<%= key %>_months" value="<%= months %>" min="0" max="11" style="width:60px;"></td>
        </tr>
      <% }); %>
    </tbody>
  </table>
  <button type="submit">Apply Cut-offs</button>
</form>

    <a href="/" class="back">Back to Main Dashboard</a>
  </div>
</body>
</html>
